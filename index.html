<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width,initial-scale=1.0,maximum-scale=1.0,user-scalable=no">
  <title>Планировщик заявок</title>
  <link rel="manifest" href="manifest.json">
  <meta name="theme-color" content="#4f46e5">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="apple-mobile-web-app-title" content="Заявки">
  <link rel="apple-touch-icon" href="icon-192.png">
  <style>
    *{margin:0;padding:0;box-sizing:border-box}
    html,body{height:100%;overflow:hidden}
    iframe{width:100%;height:100%;border:none}
    .loader{position:fixed;inset:0;background:linear-gradient(135deg,#4f46e5,#7c3aed);display:flex;flex-direction:column;align-items:center;justify-content:center;color:#fff;font-family:system-ui,sans-serif}
    .loader-icon{width:80px;height:80px;background:#fff;border-radius:20px;display:flex;align-items:center;justify-content:center;margin-bottom:24px;animation:pulse 2s infinite}
    .loader-icon svg{width:40px;height:40px;fill:#4f46e5}
    .loader-text{font-size:24px;font-weight:700;margin-bottom:8px}
    .loader-sub{font-size:14px;opacity:0.8}
    @keyframes pulse{0%,100%{transform:scale(1)}50%{transform:scale(1.05)}}
    .hidden{display:none!important}
  </style>
</head>
<body>
  <div class="loader" id="loader">
    <div class="loader-icon">
      <svg viewBox="0 0 24 24"><path d="M19 3h-1V1h-2v2H8V1H6v2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm0 16H5V8h14v11zM9 10H7v2h2v-2zm4 0h-2v2h2v-2zm4 0h-2v2h2v-2zm-8 4H7v2h2v-2zm4 0h-2v2h2v-2zm4 0h-2v2h2v-2z"/></svg>
    </div>
    <div class="loader-text">Планировщик заявок</div>
    <div class="loader-sub">Загрузка...</div>
  </div>
  <iframe id="app" class="hidden" src="https://script.google.com/macros/s/AKfycbziJi6zBrH0meVhi27JPdFquQYGhjDK2iX0EIjKrRplhW8E9CQZAkA1ZQpdiNqVsGI1/exec" allow="notifications"></iframe>
  
  <script>
    if('serviceWorker' in navigator){
      navigator.serviceWorker.register('sw.js').then(()=>console.log('SW OK')).catch(e=>console.log('SW fail',e));
    }
    
    const iframe=document.getElementById('app');
    const loader=document.getElementById('loader');
    
    iframe.onload=()=>{
      setTimeout(()=>{
        loader.classList.add('hidden');
        iframe.classList.remove('hidden');
      },500);
    };
    
    // Запрос уведомлений
    if('Notification' in window && Notification.permission==='default'){
      setTimeout(()=>Notification.requestPermission(),3000);
    }
  </script>
</body>
</html>
